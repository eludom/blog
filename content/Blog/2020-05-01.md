+++
title = "HOWTO: Using Pi-hole DNS to block ads.  The struggle continuesâ€¦"
author = ["George Jones"]
publishDate = 2020-05-01
lastmod = 2020-05-01T19:52:53-04:00
tags = ["DNS", "privacy", "networking", "HOWTO"]
draft = false
+++

_This article is a work in progress.  To be updated as exploration continues._

Day 03 of #100DaysToOffload.


## Intro {#intro}

The war against ads continues. <https://pi-hole.net/> looks like a
reasonable, good, new?, open source entry in the war against ads. Get
'yer source/install for linux at <https://github.com/pi-hole/pi-hole>

Per Paul Vixie

> not even non-technical users need a "public DNS" to shield themselves
> from a lot of known-evil internet sites. check out @The\_Pi\_Hole or
> have your 12yo child or cousin install it.

..but I always make things harder.

<a id="org24959f4"></a>

{{< figure src="/ox-hugo/pi-hole.png" caption="Figure 1: pi-hole console after a few hours on my system" >}}

<!--more-->


## What {#what}

-   It's a local DNS server to block adds.


## Why {#why}

-   Blocking ads is a moral good.
-   I've not done home network hacking for a while
-   I'm moving into a bit of a more "don't track me" frame of mind.


## When {#when}

-   Now, because I'm home more during corona-virus


## How {#how}

-   Set up local server


## Install It {#install-it}

[ ] basic install
: On a Linux server, the **basic** install is
    simple:

    ```text
                sudo bash basic-install.sh
    ```


[ ] Static IP
: But you will want a Linux box with a static IP
    address. This may involve, e.g., convincing your wireless
    router to hand out a the same static IP to a static IP


[ ] Tell other systems to use this IP for DNS
: Again, probably
    configuring your wireless router to specify your local IP as
    the DNS server for dynamic assignments.   You could also do
    this by configuring the individual devices to use it.


[ ] Remember your admin password
: Make note of the admin password during install


[ ] hit the local admin web server
: Its a very nice.  It will
    be at a something like  <http://192.168.86.230/admin/index.php>.


## Test It {#test-it}

[ ] Look something up by hand
: Use dig(1) or host(1).  Note
    the `SERVER` in the response below that shows where the answer
    came from.  If it's your IPS's DNS or Google, try again
    (something's not configured right).  In my case 127.1 is right.

<!--listend-->

```text
$ dig www.uu.net

; <<>> DiG 9.11.3-1ubuntu1.11-Ubuntu <<>> www.uu.net
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 54721
;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;www.uu.net.			IN	A

;; ANSWER SECTION:
www.uu.net.		299	IN	CNAME	global.mci.com.
global.mci.com.		959	IN	CNAME	wac.C449.edgecastcdn.net.
wac.C449.edgecastcdn.net. 3599	IN	CNAME	gp1.wac.v2cdn.net.
gp1.wac.v2cdn.net.	3599	IN	A	152.195.32.39

;; Query time: 59 msec
;; SERVER: 127.0.0.1#53(127.0.0.1)
;; WHEN: Fri May 01 19:16:11 EDT 2020
;; MSG SIZE  rcvd: 146
```

-   [ ] Check the query logs via the UI to make sure your target domain
    showed.   Be aware of caching.  It may only show up the first
    time you query.

-   [ ] Find your favorite 90s-era web site,
    go hit it, and watch the counters
    -   <http://computershopper.com>
    -   <http://www.yahoo.com>
    -   <http://www.compuserve.com>
    -   <http://www.aol.com>
    -   <http://sears.com> (get it while it lasts)

-   If the counters go crazy and you don't see the expected
    plethora of ads, you win.  If not dig deeper.

-   Browser and other apps are getting cagey about using not using
    the system DNS, using DOH, and otherwise not acting like you
    expect them too.  Editing `/etc/resolv.conf` is not the whole
    game anymore.


## POST INCOMPLETE FROM HERE {#post-incomplete-from-here}


## Migrate {#migrate}


## Burn in {#burn-in}


## Inflict it on others {#inflict-it-on-others}
